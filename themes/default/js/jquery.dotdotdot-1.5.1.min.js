(function(e){function n(e,t,n){var r=e.children(),i=!1;e.empty();for(var o=0,u=r.length;o<u;o++){var a=r.eq(o);e.append(a),n&&e.append(n);if(s(e,t)){a.remove(),i=!0;break}n&&n.remove()}return i}function r(t,n,o,u,a){var f=t.contents(),l=!1;t.empty();var c="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var h=0,p=f.length;h<p;h++){if(l)break;var d=f[h],v=e(d);if(typeof d=="undefined")continue;t.append(v);if(a){var m=t.is(c)?"after":"append";t[m](a)}d.nodeType==3?s(o,u)&&(l=i(v,n,o,u,a)):l=r(v,n,o,u,a),l||a&&a.remove()}return l}function i(t,n,r,o,f){var l=!1,c=t[0];if(typeof c=="undefined")return!1;var h=o.wrap=="letter"?"":" ",p=a(c).split(h),d=-1,v=-1,m=0,g=p.length-1;while(m<=g){var y=Math.floor((m+g)/2);if(y==v)break;v=y,u(c,p.slice(0,v+1).join(h)+o.ellipsis),s(r,o)?g=v:(d=v,m=v)}if(d!=-1){var b=p.slice(0,d+1).join(h);l=!0;while(e.inArray(b.slice(-1),o.lastCharacter.remove)>-1)b=b.slice(0,-1);e.inArray(b.slice(-1),o.lastCharacter.noEllipsis)<0&&(b+=o.ellipsis),u(c,b)}else{var w=t.parent();t.remove(),$n=w.contents().eq(-1),l=i($n,n,r,o,f)}return l}function s(e,t){return e.innerHeight()>t.maxHeight}function o(e){return{width:e.innerWidth(),height:e.innerHeight()}}function u(e,t){e.innerText?e.innerText=t:e.nodeValue?e.nodeValue=t:e.textContent&&(e.textContent=t)}function a(e){return e.innerText?e.innerText:e.nodeValue?e.nodeValue:e.textContent?e.textContent:""}function f(t,n){return typeof t=="undefined"?!1:t?typeof t=="string"?(t=e(t,n),t.length?t:!1):typeof t=="object"?typeof t.jquery=="undefined"?!1:t:!1:!1}function c(e){var t=e.innerHeight(),n=["paddingTop","paddingBottom"];for(z=0,l=n.length;z<l;z++){var r=parseInt(e.css(n[z]),10);isNaN(r)&&(r=0),t-=r}return t}function h(e,t){return e?(typeof t=="string"?t="dotdotdot: "+t:t=["dotdotdot:",t],window.console&&window.console.log&&window.console.log(t),!1):!1}if(e.fn.dotdotdot)return;e.fn.dotdotdot=function(i){if(this.length==0)return h(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){e(this).dotdotdot(i)});var u=this;u.data("dotdotdot")&&u.trigger("destroy.dot"),u.bind_events=function(){return u.bind("update.dot",function(t,i){t.preventDefault(),t.stopPropagation(),l.maxHeight=typeof l.height=="number"?l.height:c(u),l.maxHeight+=l.tolerance;if(typeof i!="undefined"){if(typeof i=="string"||i instanceof HTMLElement)i=e("<div />").append(i).contents();i instanceof e&&(a=i)}m=u.wrapInner('<div class="dotdotdot" />').children(),m.empty().append(a.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var o=!1,f=!1;return p.afterElement&&(o=p.afterElement.clone(!0),p.afterElement.remove()),s(m,l)&&(l.wrap=="children"?f=n(m,l,o):f=r(m,u,m,l,o)),m.replaceWith(m.contents()),m=null,e.isFunction(l.callback)&&l.callback.call(u[0],f,a),p.isTruncated=f,f}).bind("isTruncated.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),typeof t=="function"&&t.call(u[0],p.isTruncated),p.isTruncated}).bind("originalContent.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),typeof t=="function"&&t.call(u[0],a),a}).bind("destroy.dot",function(e){e.preventDefault(),e.stopPropagation(),u.unwatch().unbind_events().empty().append(a).data("dotdotdot",!1)}),u},u.unbind_events=function(){return u.unbind(".dot"),u},u.watch=function(){u.unwatch();if(l.watch=="window"){var t=e(window),n=t.width(),r=t.height();t.bind("resize.dot"+p.dotId,function(){if(n!=t.width()||r!=t.height()||!l.windowResizeFix)n=t.width(),r=t.height(),v&&clearInterval(v),v=setTimeout(function(){u.trigger("update.dot")},10)})}else d=o(u),v=setInterval(function(){var e=o(u);if(d.width!=e.width||d.height!=e.height)u.trigger("update.dot"),d=o(u)},100);return u},u.unwatch=function(){return e(window).unbind("resize.dot"+p.dotId),v&&clearInterval(v),u};var a=u.contents(),l=e.extend(!0,{},e.fn.dotdotdot.defaults,i),p={},d={},v=null,m=null;return p.afterElement=f(l.after,u),p.isTruncated=!1,p.dotId=t++,u.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&u.watch(),u},e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1};var t=1,p=e.fn.html;e.fn.html=function(e){if(typeof e!="undefined")return this.data("dotdotdot")&&typeof e!="function"?this.trigger("update",[e]):p.call(this,e);return p.call(this)};var d=e.fn.text;e.fn.text=function(t){if(typeof t!="undefined"){if(this.data("dotdotdot")){var n=e("<div />");return n.text(t),t=n.html(),n.remove(),this.trigger("update",[t])}return d.call(this,t)}return d.call(this)}})(jQuery)